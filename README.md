# Wizard of Music bot

Бот предназначен для соединения пар пользователей (покупатель и продавец), которые бы между собой торговались.

Каждый юзер может находиться в 4 состояниях (`current_role`):
- `active`    - не играет, но готов начинать игру прямо сейчас
- `inactive`  - не играет, и не готов начинать игру прямо сейчас
- `buyer/seller` - играет с соответствующей ролью

Возможные переходы:
 - `inactive --> buyer/seller`: по кнопке "начать игру" (если есть с кем играть, т.е. есть кто-то в состоянии `active`). 
 Выбор между ролями `buyer` и `seller` совершается случайно.
 - `inactive --> active`: по кнопке "начать игру" (если не с кем играть)
 - `active --> buyer/seller`: если другой игрок нажал "начать игру"
 - `active --> inactive`: по кнопке "не начинать игру"
 - `buyer/seller --> inactive`: по кнопке "завершить игру" (в т.ч. если её нажмёт второй игрок)

Кроме этого, у каждого состояния есть два бинарный модификатор `allow_notifications`,
он определяет, получает ли юзер, находясь в состоянии inactive, уведомления
о других игроках, переходящих в состояние active. Он переключается отдельной кнопкой 
"получать уведомления" / "не получать уведомления". 

Все сообщения логируются в mongodb. В отдельную табличку логируются все события, непосредственно относящиеся к игре
(сообщения внутри игры, а также начало и конец игры). 
